# Certificados .p12 / .pfx

Todo lo necesario para usar certificados digitales con **Maya | Signer**.

## ¿Qué es un certificado .p12/.pfx?

Un archivo `.p12` (o `.pfx` en Windows) es un contenedor que incluye:

- Tu **clave privada** (para firmar)
- Tu **certificado público** (para verificar)
- Certificatos de la **cadena de confianza** (de la autoridad que te lo emitió)

::: info .p12 vs .pfx
Son exactamente el mismo formato. Microsoft usa la extensión `.pfx` y el estándar general usa `.p12`. **Maya | Signer** acepta ambas.
:::

## Obtener un Certificado

Los certificados se emiten por **Autoridades Certificadoras** (AC). Las principales en España:

| Autoridad | Tipo | Precio |
|-----------|------|--------|
| FNMT (Fábrica Nacional de Moneda y Timbre) | Personal | Gratuito |
| Camerfirma | Personal / Empresa | Pago |
| ACCV | Personal / Empresa | Pago |
| GlobalSign | Empresa | Pago |

### Obtener certificado FNMT (gratuito)

1. Ve a [https://www.fnmt.es](https://www.fnmt.es)
2. Solicita el certificado desde tu navegador
3. Acredita tu identidad (con DNIe o presencial)
4. Descarga el certificado
5. **Exporta a .p12**: En tu navegador → Configuración → Privacidad → Certificados → Exportar → Selecciona formato PKCS#12

## Usar Certificado en Maya Signer

### En el diálogo de credenciales

1. **Deselecciona** "Usar DNIe" (si está marcado)
2. Haz clic en **Examinar...**
3. Selecciona tu archivo `.p12` o `.pfx`
4. Introduce la **contraseña del certificado**

::: warning Contraseña
La contraseña del certificado es la que elegiste cuando lo exportaste a .p12.
:::

### Ubicación recomendada del archivo

Guarda tu certificado en un lugar seguro y accesible:

::: code-group

```bash [Linux]
~/.maya_signer/certificado.p12
# O en una carpeta personal
~/Documentos/Certificados/mi_certificado.p12
```

```powershell [Windows]
%USERPROFILE%\Documents\Certificados\mi_certificado.p12
```

```bash [macOS]
~/Documents/Certificados/mi_certificado.p12
```

:::

::: danger Seguridad
- **Nunca** compartas tu archivo .p12 con nadie
- **Nunca** lo subas a internet ni lo envíes por email
- Mantén una **copia de seguridad** en un lugar seguro
- Si pierdas tu clave privada, no podrás firmar ni recuperarla
:::

## Problemas Comunes

### "Error al cargar certificado"

- Verifica que la contraseña es correcta
- Asegúrate de que el archivo no está corrupto (prueba abrirlo con otra herramienta)
- El certificado puede estar expirado

### "Certificado expirado"

Los certificados tienen una fecha de caducidad. Cuando expira:

1. Solicita un nuevo certificado a tu AC
2. Exporta el nuevo a .p12
3. En **Maya | Signer**, selecciona el nuevo archivo

### Verificar un certificado

::: code-group

```bash [Linux/macOS]
# Ver información del certificado
openssl pkcs12 -in certificado.p12 -info -nokeys -passin pass:tu_contraseña

# Ver fecha de caducidad
openssl pkcs12 -in certificado.p12 -nokeys -passin pass:tu_contraseña | openssl x509 -noout -dates
```

```powershell [Windows]
# Ver certificados instalados en el sistema
certutil -dump certificado.p12
```

:::

## Firma por Lotes con Certificado

La firma con certificado .p12 es **ideal para lotes grandes** porque:

- No requiere interacción del usuario por cada documento
- Se firman todos los documentos automáticamente
- Es más rápido que usar DNIe

El flujo es:

1. Introduces la contraseña del certificado **una sola vez**
2. **Maya | Signer** firma todos los documentos del lote
3. Te notifica el resultado
